<!doctype html>
<html class="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    function validateForm() {
      let gameName = document.getElementById('game-name').value;
      let childAge = document.getElementById('child-age').value;
      let id = document.getElementById('id').value;
      
      let url = `/title/${gameName}/${id}/${childAge}`;

      location.href = url;
      return false;
    }
  </script>

</head>

<body>
  <div>
    <header class="absolute inset-x-0 top-0 z-50">
      <nav class="flex items-center justify-between p-6 lg:px-8" aria-label="Global">
        <div class="flex lg:flex-1">
        </div>
        <div class="flex lg:hidden">
          <button type="button" class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700">
            <span class="sr-only">Open main menu</span>
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
              aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
          </button>
        </div>
        <div class="hidden lg:flex lg:gap-x-12">
          <img class="h-14 w-auto" src="./images/Xbox_Logo.svg" alt="">

        </div>
        <div class="hidden lg:flex lg:flex-1 lg:justify-end">
          <a href="#" class="text-sm font-semibold leading-6 text-gray-900"></a>
        </div>
      </nav>

    </header>

    <div class="relative isolate px-6 pt-14 lg:px-8">

      <div class="mx-auto max-w-2xl py-32">
        <div class="hidden sm:mb-8 sm:flex sm:justify-center">

        </div>
        <div class="text-center">
          <h1 class="text-4xl font-bold tracking-tight text-gray-900 sm:text-6xl">Is this game safe for my child?</h1>
          <p class="mt-6 text-lg leading-8 text-gray-600">Enter the name of the game and the age of your child to
            determine whether or not it is safe.</p>


          <form action="/title" method="get" onsubmit="return validateForm();">

            <div class="mt-6 flex gap-x-4 ">
              <!-- Drop down Selector -->
              <div class="w-96 relative" onclick="event.stopImmediatePropagation();">
              <label for="game-name" class="sr-only">Game Name</label>
              <input id="game-name" name="game-name" type="text" required
                class="px-5 py-3 w-full border border-gray-300 rounded-md"
                placeholder="Game Name" onkeyup="onkeyUp(event)">
                <div
                id="dropdown"
                class="w-full h-60 border border-gray-300 rounded-md bg-white absolute overflow-y-auto hidden"></div>

                <input type="hidden" id="id" name="id" />
            </div>
              

              <label for="child-age" class="sr-only">Child Age</label>
              <input id="child-age" name="child-age" type="text" required
                class="px-5 py-3 w-full border border-gray-300 rounded-md"
                placeholder="Child Age">

              <input type="submit"
                class="flex-none rounded-md bg-green-700 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-green-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-green-500"
                value="Check">
            </div>

          </form>
        </div>
      </div>
    </div>


    <!-- Show details -->
    <!--{{Details}}-->

  </div>

</body>
<script>
  let games = [
    { name: "Halo Infinite", code: "1" },
    { name: "Minecraft", code: "2" },
    { name: "Forza Horizon 5", code: "3" },
    { name: "Minecraft Legends", code: "4" },
  ];

  function onkeyUp(e) {
    let keyword = e.target.value;
    let dropdownEl = document.querySelector("#dropdown");
    dropdownEl.classList.remove("hidden");
    let filteredGames = games.filter((c) =>
      c.name.toLowerCase().includes(keyword.toLowerCase())
    );

    renderOptions(filteredGames);
  }

  document.addEventListener("DOMContentLoaded", () => {
    renderOptions(games);
  });

  function renderOptions(options) {
    let dropdownEl = document.querySelector("#dropdown");

    let newHtml = ``;

    options.forEach((country) => {
      newHtml += `<div
            onclick="selectOption('${country.name}', '${country.code}')"
            class="px-5 py-3 border-b border-gray-200 text-stone-600 cursor-pointer hover:bg-slate-100 transition-colors"
          >
            ${country.name}
          </div>`;
    });

    dropdownEl.innerHTML = newHtml;
  }

  function selectOption(countryName, countryCode) {
    hideDropdown();
    let input = document.querySelector("#game-name");
    input.value = countryName;

    let id = document.querySelector("#id");
    id.value = countryCode;

  }

  document.addEventListener("click", () => {
    hideDropdown();
  });

  function hideDropdown() {
    let dropdownEl = document.querySelector("#dropdown");
    dropdownEl.classList.add("hidden");
  }


</script>

</html>